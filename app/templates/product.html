  {% extends "base.html" %}

  {% block title %}Product Management{% endblock %}

  {% block extra_css %}
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <link href="{{ url_for('static', filename='css/product.css') }}" rel="stylesheet" />
  {% endblock %}

  {% block content %}
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="mb-0">Products</h2>
    <button class="btn btn-primary" id="btnAdd">Add Product</button>
  </div>

  <div class="frosted-table-container">
  <table id="productTable" class="table table-striped table-hover table-bordered align-middle rounded-3 overflow-hidden shadow">
    <thead >
      <tr>
        <th>ID</th>
        <th>Product Code</th>
        <th>Created By</th>
        <th>Name</th>
        <th>Category</th>
        <th>Brand</th>
        <th>Image</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for p in products %}
      <tr data-id="{{ p.id }}">
        <td>{{ p.id }}</td>
        <td>{{ p.product_code or '-' }}</td>
        <td>{{ p.created_by or '-' }}</td>
        <td>{{ p.name }}</td>
        <td>{{ p.category_name }}</td>
        <td>{{ p.brand_name }}</td>
        <td>
          {% if p.image_path %}
          <img src="{{ url_for('static', filename='uploads/' ~ p.image_path) }}" width="50" alt="Product Image" />
          {% else %} - {% endif %}
        </td>
        <td>
          <div class="form-check form-switch">
            <input type="checkbox" class="form-check-input status-toggle" id="toggle-{{ p.id }}" data-id="{{ p.id }}" {% if p.status == '1' %}checked{% endif %} />
            <label class="form-check-label" for="toggle-{{ p.id }}"></label>
          </div>
        </td>
        <td>
          <button class="btn btn-sm btn-info btn-edit">Edit</button>
          <button class="btn btn-sm btn-danger btn-delete">Delete</button>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  </div>




  <!-- Product Modal -->
  <div class="modal fade" id="productModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog ">
      <form id="productForm" enctype="multipart/form-data" novalidate>
        <div class="modal-content">
          <div class="modal-header text-bold text-white">
            <h5 id="modalTitle" class="modal-title">Add Product</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <input type="hidden" id="productId" name="productId" />
            <div class="mb-3">
              <label for="name" class="form-label">Product Name<span class="required-asterisk">*</span></label>
              <input type="text" id="name" name="name" class="form-control" />
            </div>
            <div class="mb-3" id="productCodeContainer" style="display: none;">
              <label for="product_code" class="form-label">Product Code</label>
              <input type="text" id="product_code" name="product_code" class="form-control" readonly />
            </div>
            <div class="mb-3">
              <label for="category" class="form-label">Category<span class="required-asterisk">*</span></label>
              <select id="category" name="category_id" class="form-select">
                <option value="">Select Category</option>
                {% for c in categories %}
                <option value="{{ c.id }}">{{ c.name }}</option>
                {% endfor %}
              </select>
            </div>
            <div class="mb-3">
              <label for="brand" class="form-label">Brand<span class="required-asterisk">*</span></label>
              <select id="brand" name="brand_id" class="form-select">
                <option value="">Select Brand</option>
              </select>
            </div>
            <div class="mb-3">
              <label for="image" class="form-label">Image (optional)</label>
              <input type="file" name="image" id="image" class="form-control" accept="image/jpeg, image/png" />
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="submit" class="btn btn-primary" id="saveBtn">Save</button>
          </div>
        </div>
      </form>
    </div>
  </div>
  {% endblock %}

  {% block extra_js %}
    <script src="{{url_for('static', filename='js/select2.min.js')}}"></script>
    <script src="{{url_for('static', filename='js/jquery.validate.min.js')}}"></script>
    <script src="  {{url_for('static', filename='js/additional-methods.min.js')}}"></script>
    <script src="{{ url_for('static', filename='js/product.js') }}"></script>
  {% endblock %}

  <!-- {{url_for('static', filename='js/select2.min.js')}} -->